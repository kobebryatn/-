<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./css/regierst.css">
</head>

<body>
    <header>
        <img src="./image/index/logo.jpg" alt="">
        <img src="./image/index/my.jpg" alt="">
        <img src="./image/index/xiazai.jpg" alt="">
    </header>
    <input type="text" name="phone" id="phone" value="请输入手机号">
    <input type="password" name="password" id="password"> 
    <button class="zhuce">注册</button><button class="denglu">请直接登录</button>
    <script src="./js/zepto.js"></script>
    <script>
        $(function () {
            function setRem() {
                var clienWidth = $(window).width();
                var uiWidth = 375 //ui设计稿的宽度
                var nowRem = (clienWidth / uiWidth * 100);
                $('html').css('font-size', parseInt(nowRem, 10) + 'px');

            }
            setRem();
            var timer;
            $(window).on('resize', function () {
                clearTimeout(timer);
                timer = setTimeout(function () {
                    setRem();
                }, 100)
            });
        });





        $('.zhuce').on('click', function () {
            //进行表单验证
            var gr_tel = $('#phone').val();
            // 1--以1为开头；
            // 2--第二位可为3, 4, 5, 7, 8, 中的任意一位；
            // 3--最后以0 - 9的9个整数结尾。
            var re = /^[1][3,4,5,7,8][0-9]{9}$/;
            if (!re.test(gr_tel)) {
                alert("请输入正确手机号码！");
                return false;
            }
            //后台注册接口
            // https://www.apiopen.top/createUser?key=00d91e8e0cca2b76f515926a36db68f5&phone=13594347817&passwd=123654
            $.ajax({
                url: 'https://www.apiopen.top/createUser',
                data: {
                    key: '00d91e8e0cca2b76f515926a36db68f5',
                    phone: $('#phone').val(),
                    passwd: $('#password').val(),
                },
                type: 'POST',
                dataType: 'json',
                success: function (data) {
                    console.log(data);
                    if (data.code === 200) {
                        setTimeout(function () {
                            window.location.href = './login.html';
                        }, 1000)
                    } else if (data.code === 202) {
                        alert(data.msg);
                    } else if (data.msg == '用户已注册!') {
                        alert('请点击直接跳转登录页面！');
                    }
                },
            })
        })
        $('.denglu').on('click', function () {
            window.location.href = './login.html';
        })


    </script>
</body>

</html>